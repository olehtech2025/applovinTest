<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">

    <meta
            http-equiv="Content-Security-Policy"
            content="
      default-src * data: blob: 'unsafe-inline' 'unsafe-eval';
      script-src * data: blob: 'unsafe-inline' 'unsafe-eval';
      style-src * 'unsafe-inline';
      img-src * data: blob:;
      media-src *;
    "
    />

    <meta name="viewport" content="initial-scale=1, width=device-width, viewport-fit=cover">
    <link rel="stylesheet" href="css/index.css">
    <title>Cordova App</title>
</head>

<body>
<div class="app">
    <h1>Apache Cordova</h1>
    <div id="deviceready" class="blink">
        <p class="event listening">Connecting to Device</p>
        <p class="event received">Device is Ready</p>
    </div>
</div>

<!-- Cordova -->
<script src="cordova.js"></script>

<!-- Mediator -->
<script src="AppLovinMediator.js"></script>

<script>
    (function(u,T){typeof exports=="object"&&typeof module<"u"?T(exports):typeof define=="function"&&define.amd?define(["exports"],T):(u=typeof globalThis<"u"?globalThis:u||self,T(u.coreSDK={}))})(this,(function(u){"use strict";const f={configUrl:"http://localhost:3000",authUrl:"http://localhost:3001",profileUrl:"http://localhost:3002"};function O(n){f.configUrl=n}function G(n){f.authUrl=n}function W(n){f.profileUrl=n}const Y="coreSDK_profiles_v1",Pe=100,L=300*1e3;class Ie{constructor(e){this.items=new Map,this.maxItems=e?.maxItems??Pe,this.loadFromStorage()}get(e){const t=this.items.get(e);if(!t)return null;const s=Date.now();return s-t.cachedAt>t.ttl?(this.items.delete(e),this.saveToStorageSafe(),null):(t.lastAccessed=s,t.profile)}set(e,t){const s=Date.now(),i={profile:e,cachedAt:s,lastAccessed:s,ttl:t};this.items.set(e.id,i),this.evictIfNeeded(),this.saveToStorageSafe()}invalidate(e){this.items.delete(e)&&this.saveToStorageSafe()}invalidateAll(){this.items.clear(),this.saveToStorageSafe()}evictIfNeeded(){if(this.items.size<=this.maxItems)return;const e=Array.from(this.items.entries());e.sort((s,i)=>s[1].lastAccessed-i[1].lastAccessed);const t=e.length-this.maxItems;for(let s=0;s<t;s++){const[i]=e[s];this.items.delete(i)}}loadFromStorage(){if(!(typeof localStorage>"u"))try{const e=localStorage.getItem(Y);if(!e)return;const t=JSON.parse(e);if(t.version!==1||!t.items||typeof t.items!="object")return;const s=Date.now();for(const[i,o]of Object.entries(t.items))!o||!o.profile||typeof o.cachedAt!="number"||typeof o.ttl!="number"||s-o.cachedAt>o.ttl||this.items.set(i,o);this.evictIfNeeded()}catch(e){console.error("[ProfileCache] loadFromStorage error:",e)}}saveToStorageSafe(){if(!(typeof localStorage>"u"))try{const e={};for(const[s,i]of this.items.entries())e[s]=i;const t={version:1,items:e};localStorage.setItem(Y,JSON.stringify(t))}catch(e){console.error("[ProfileCache] saveToStorageSafe error:",e)}}}const B={PROFILE_UPDATED:"profile.updated"};class P{constructor(e,t){this.cache=new Ie,this.myProfileId=null,this.getAuthToken=e,this.events=t}buildUrl(e){const t=f.authUrl.replace(/\/+$/,""),s=e.replace(/^\/+/,"");return`${t}/${s}`}async request(e,t={}){const s=this.buildUrl(e);let i=this.getAuthToken();!i&&typeof localStorage<"u"&&(i=localStorage.getItem("coreSDK_token")||void 0);const o={"Content-Type":"application/json",...t.headers};i&&(o.Authorization=`Bearer ${i}`);const r=await fetch(s,{...t,headers:o,credentials:"include"});if(!r.ok){const d=await r.text();let c=`Request failed with status ${r.status}`;try{const l=JSON.parse(d);Array.isArray(l.message)?c=l.message.join(", "):l.message?c=l.message:l.error&&(c=l.error)}catch{}throw new Error(c)}const a=await r.text();return a?JSON.parse(a):null}emitUpdate(e){this.events.emit(B.PROFILE_UPDATED,{id:e.id,profile:e}),typeof window<"u"&&window.dispatchEvent(new CustomEvent(B.PROFILE_UPDATED,{detail:{id:e.id,profile:e}}))}async getProfile(){if(this.myProfileId){const t=this.cache.get(this.myProfileId);if(t)return t}const e=await this.request("/v1/auth/me");return this.myProfileId=e.id,this.cache.set(e,L),e}async getProfileField(e){return(await this.request(`/v1/profiles/me/field/${e}`)).value}async updateProfile(e){const t=await this.request("/v1/profiles/me",{method:"PATCH",body:JSON.stringify(e)});return this.myProfileId=t.id,this.cache.set(t,L),this.emitUpdate(t),t}async setProfileField(e,t){const s=await this.request(`/v1/profiles/me/field/${e}`,{method:"PUT",body:JSON.stringify({value:t})});return this.myProfileId&&this.cache.invalidate(this.myProfileId),s.value}async mergeProfileScope(e,t){const s=await this.request(`/v1/profiles/me/scope/${e}`,{method:"PATCH",body:JSON.stringify({data:t})});return this.myProfileId=s.id,this.cache.set(s,L),this.emitUpdate(s),s}invalidate(e){e?this.cache.invalidate(e):this.myProfileId&&this.cache.invalidate(this.myProfileId)}invalidateAll(){this.cache.invalidateAll()}resetMyProfileId(){this.myProfileId=null}}class Q{constructor(e){this.getAuthToken=e}buildUrl(e){const t=f.configUrl.replace(/\/+$/,""),s=e.replace(/^\/+/,"");return`${t}/${s}`}async request(e,t={}){const s=this.buildUrl(e),i=this.getAuthToken(),o={"Content-Type":"application/json",...t.headers};i&&(o.Authorization=`Bearer ${i}`),console.log("[API] REQUEST:",{url:s,method:t.method??"GET",headers:o,body:t.body});const r=await fetch(s,{...t,headers:o,credentials:"include"});if(!r.ok){const d=await r.text().catch(()=>"");throw console.error("[API] Request failed:",{url:s,status:r.status,body:d}),new Error(`Request failed with status ${r.status}`)}const a=await r.text();if(!a)return null;try{return JSON.parse(a)}catch(d){return console.warn("[API] Response is not JSON, returning as text:",d),a}}normalizeBody(e){return e===void 0?void 0:JSON.stringify(e)}send(e,t,s){return this.request(t,{method:e,body:this.normalizeBody(s)})}get(e){return this.send("GET",e)}post(e,t){return this.send("POST",e,t)}put(e,t){return this.send("PUT",e,t)}patch(e,t){return this.send("PATCH",e,t)}delete(e){return this.send("DELETE",e)}}class X{constructor(){this.listeners=new Map,this.onceListeners=new Map}on(e,t){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t)}once(e,t){this.onceListeners.has(e)||this.onceListeners.set(e,new Set),this.onceListeners.get(e).add(t)}off(e,t){this.listeners.get(e)?.delete(t),this.onceListeners.get(e)?.delete(t)}emit(e,...t){this.listeners.get(e)?.forEach(i=>i(...t));const s=this.onceListeners.get(e);s&&(s.forEach(i=>i(...t)),this.onceListeners.delete(e))}}const Z="https://accounts.google.com/gsi/client",H=class H{static async loadScript(){if(typeof window>"u")throw new Error("GoogleAuthHelper requires browser environment");if(!window.google?.accounts?.id)return this.scriptLoading?this.scriptLoading:(this.scriptLoading=new Promise((e,t)=>{const s=document.querySelector(`script[src="${Z}"]`);if(s){s.addEventListener("load",()=>e()),s.addEventListener("error",()=>t(new Error("Failed to load Google Sign-In")));return}const i=document.createElement("script");i.src=Z,i.async=!0,i.defer=!0,i.onload=()=>e(),i.onerror=()=>t(new Error("Failed to load Google Sign-In")),document.head.appendChild(i)}),this.scriptLoading)}static requestToken(e,t){return new Promise((s,i)=>{if(!window.google?.accounts?.id){i(new Error("Google Identity Services not loaded"));return}window.google.accounts.id.initialize({client_id:e,callback:o=>{o.credential?s(o):i(new Error("No credential received from Google"))},auto_select:!1,cancel_on_tap_outside:!1}),t?.useOneTap?window.google.accounts.id.prompt(o=>{if(o.isNotDisplayed()||o.isSkippedMoment()){const r=o.isNotDisplayed()?o.getNotDisplayedReason():o.getSkippedReason();i(new Error(`Google One Tap unavailable: ${r}. Try without useOneTap option.`))}}):this.triggerButtonPopup(e,s,i)})}static triggerButtonPopup(e,t,s){const i=document.createElement("div");i.style.position="fixed",i.style.top="-9999px",i.style.left="-9999px",document.body.appendChild(i);let o=!1;const r=()=>{i.parentNode&&i.parentNode.removeChild(i)},a=setTimeout(()=>{o||(r(),s(new Error("Google Sign-In timeout or cancelled by user")))},12e4);window.google.accounts.id.initialize({client_id:e,callback:d=>{o=!0,clearTimeout(a),r(),d.credential?t(d):s(new Error("No credential received from Google"))}}),window.google.accounts.id.renderButton(i,{type:"standard",size:"large",click_listener:()=>{console.log("[GoogleAuthHelper] Button clicked, waiting for response...")}}),requestAnimationFrame(()=>{const d=i.querySelector("div[role='button']");if(d)d.click();else{const c=i.querySelector("*");c&&c.click()}})}static isAvailable(){return typeof window<"u"&&!!window.google?.accounts?.id}static cancel(){window.google?.accounts?.id&&window.google.accounts.id.cancel()}};H.scriptLoading=null;let _=H;class ee{constructor(e){this.backdrop=null,this.options=e}show(){this.backdrop||(this.backdrop=document.createElement("div"),this.backdrop.className="coresdk-auth-backdrop",this.backdrop.innerHTML=this.getHTML(),this.injectStyles(),document.body.appendChild(this.backdrop),this.attachEvents())}hide(){this.backdrop&&(this.backdrop.remove(),this.backdrop=null)}getHTML(){return`
            <div class="coresdk-auth-modal">
                <h2 class="coresdk-auth-title">Choose Sign In Method</h2>
                <p class="coresdk-auth-subtitle">Select how you want to continue</p>

                <div class="coresdk-auth-buttons">
                    <button
                        class="coresdk-auth-btn coresdk-auth-btn-google"
                        data-action="google"
                        ${this.options.googleEnabled===!1?"disabled":""}
                    >
                        <svg viewBox="0 0 24 24" width="20" height="20">
                            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                        <span>Continue with Google</span>
                    </button>

                    <button class="coresdk-auth-btn coresdk-auth-btn-guest" data-action="guest">
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                        </svg>
                        <span>Continue as Guest</span>
                    </button>
                </div>

                <p class="coresdk-auth-hint">
                    Guest accounts are linked to this device
                </p>
            </div>
        `}injectStyles(){if(document.getElementById("coresdk-auth-styles"))return;const e=document.createElement("style");e.id="coresdk-auth-styles",e.textContent=`
            .coresdk-auth-backdrop {
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 999999;
                animation: coresdk-fadeIn 0.2s ease;
            }

            @keyframes coresdk-fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }

            @keyframes coresdk-slideUp {
                from {
                    opacity: 0;
                    transform: translateY(20px) scale(0.95);
                }
                to {
                    opacity: 1;
                    transform: translateY(0) scale(1);
                }
            }

            .coresdk-auth-modal {
                background: #fff;
                border-radius: 16px;
                padding: 32px;
                width: 340px;
                max-width: 90vw;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                animation: coresdk-slideUp 0.3s ease;
            }

            .coresdk-auth-title {
                margin: 0 0 8px;
                font-size: 22px;
                font-weight: 600;
                color: #1a1a1a;
                text-align: center;
                font-family: system-ui, -apple-system, sans-serif;
            }

            .coresdk-auth-subtitle {
                margin: 0 0 24px;
                font-size: 14px;
                color: #666;
                text-align: center;
                font-family: system-ui, -apple-system, sans-serif;
            }

            .coresdk-auth-buttons {
                display: flex;
                flex-direction: column;
                gap: 12px;
            }

            .coresdk-auth-btn {
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 12px;
                padding: 14px 20px;
                border-radius: 12px;
                font-size: 15px;
                font-weight: 500;
                cursor: pointer;
                transition: all 0.2s ease;
                border: none;
                font-family: system-ui, -apple-system, sans-serif;
            }

            .coresdk-auth-btn:disabled {
                opacity: 0.5;
                cursor: not-allowed;
            }

            .coresdk-auth-btn-google {
                background: #fff;
                border: 1px solid #ddd;
                color: #333;
            }

            .coresdk-auth-btn-google:hover:not(:disabled) {
                background: #f8f8f8;
                border-color: #ccc;
                transform: translateY(-1px);
            }

            .coresdk-auth-btn-guest {
                background: #333;
                color: #fff;
            }

            .coresdk-auth-btn-guest:hover:not(:disabled) {
                background: #444;
                transform: translateY(-1px);
            }

            .coresdk-auth-btn svg {
                flex-shrink: 0;
            }

            .coresdk-auth-hint {
                margin: 20px 0 0;
                font-size: 12px;
                color: #999;
                text-align: center;
                font-family: system-ui, -apple-system, sans-serif;
            }

            .coresdk-auth-btn.loading {
                pointer-events: none;
                opacity: 0.7;
            }

            .coresdk-auth-btn.loading span {
                opacity: 0.5;
            }
        `,document.head.appendChild(e)}attachEvents(){if(!this.backdrop)return;const e=this.backdrop.querySelector('[data-action="google"]'),t=this.backdrop.querySelector('[data-action="guest"]');e?.addEventListener("click",async()=>{if(!e.disabled){e.classList.add("loading");try{await this.options.onGoogleClick(),this.hide()}catch(s){console.error("[AuthModal] Google auth error:",s),e.classList.remove("loading")}}}),t?.addEventListener("click",async()=>{t.classList.add("loading");try{await this.options.onGuestClick(),this.hide()}catch(s){console.error("[AuthModal] Guest auth error:",s),t.classList.remove("loading")}}),this.backdrop.addEventListener("click",s=>{s.target===this.backdrop&&(this.hide(),this.options.onClose?.())})}}const v=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,p=globalThis,E="10.27.0";function te(){return M(p),p}function M(n){const e=n.__SENTRY__=n.__SENTRY__||{};return e.version=e.version||E,e[E]=e[E]||{}}function N(n,e,t=p){const s=t.__SENTRY__=t.__SENTRY__||{},i=s[E]=s[E]||{};return i[n]||(i[n]=e())}const Ke="Sentry Logger ",se={};function xe(n){if(!("console"in p))return n();const e=p.console,t={},s=Object.keys(se);s.forEach(i=>{const o=se[i];t[i]=e[i],e[i]=o});try{return n()}finally{s.forEach(i=>{e[i]=t[i]})}}function Ue(){q().enabled=!0}function Re(){q().enabled=!1}function ie(){return q().enabled}function Oe(...n){$("log",...n)}function Ge(...n){$("warn",...n)}function Le(...n){$("error",...n)}function $(n,...e){v&&ie()&&xe(()=>{p.console[n](`${Ke}[${n}]:`,...e)})}function q(){return v?N("loggerSettings",()=>({enabled:!1})):{enabled:!1}}const I={enable:Ue,disable:Re,isEnabled:ie,log:Oe,warn:Ge,error:Le},Be=Object.prototype.toString;function Me(n,e){return Be.call(n)===`[object ${e}]`}function Ne(n){return Me(n,"Object")}function $e(n){return!!(n?.then&&typeof n.then=="function")}function qe(n,e,t){try{Object.defineProperty(n,e,{value:t,writable:!0,configurable:!0})}catch{v&&I.log(`Failed to add non-enumerable property "${e}" to object`,n)}}function Fe(n,e=0){return typeof n!="string"||e===0||n.length<=e?n:`${n.slice(0,e)}...`}function je(){const n=p;return n.crypto||n.msCrypto}let F;function Je(){return Math.random()*16}function k(n=je()){try{if(n?.randomUUID)return n.randomUUID().replace(/-/g,"")}catch{}return F||(F="10000000100040008000"+1e11),F.replace(/[018]/g,e=>(e^(Je()&15)>>e/4).toString(16))}const ne=1e3;function oe(){return Date.now()/ne}function He(){const{performance:n}=p;if(!n?.now||!n.timeOrigin)return oe;const e=n.timeOrigin;return()=>(e+n.now())/ne}let re;function ze(){return(re??(re=He()))()}function Ve(n,e={}){if(e.user&&(!n.ipAddress&&e.user.ip_address&&(n.ipAddress=e.user.ip_address),!n.did&&!e.did&&(n.did=e.user.id||e.user.email||e.user.username)),n.timestamp=e.timestamp||ze(),e.abnormal_mechanism&&(n.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(n.ignoreDuration=e.ignoreDuration),e.sid&&(n.sid=e.sid.length===32?e.sid:k()),e.init!==void 0&&(n.init=e.init),!n.did&&e.did&&(n.did=`${e.did}`),typeof e.started=="number"&&(n.started=e.started),n.ignoreDuration)n.duration=void 0;else if(typeof e.duration=="number")n.duration=e.duration;else{const t=n.timestamp-n.started;n.duration=t>=0?t:0}e.release&&(n.release=e.release),e.environment&&(n.environment=e.environment),!n.ipAddress&&e.ipAddress&&(n.ipAddress=e.ipAddress),!n.userAgent&&e.userAgent&&(n.userAgent=e.userAgent),typeof e.errors=="number"&&(n.errors=e.errors),e.status&&(n.status=e.status)}function ae(n,e,t=2){if(!e||typeof e!="object"||t<=0)return e;if(n&&Object.keys(e).length===0)return n;const s={...n};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(s[i]=ae(s[i],e[i],t-1));return s}function ce(){return k()}const j="_sentrySpan";function le(n,e){e?qe(n,j,e):delete n[j]}function de(n){return n[j]}const We=100;class m{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._attributes={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:ce(),sampleRand:Math.random()}}clone(){const e=new m;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._attributes={...this._attributes},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,le(e,de(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Ve(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this.setTags({[e]:t})}setAttributes(e){return this._attributes={...this._attributes,...e},this._notifyScopeListeners(),this}setAttribute(e,t){return this.setAttributes({[e]:t})}removeAttribute(e){return e in this._attributes&&(delete this._attributes[e],this._notifyScopeListeners()),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return t===null?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const t=typeof e=="function"?e(this):e,s=t instanceof m?t.getScopeData():Ne(t)?e:void 0,{tags:i,attributes:o,extra:r,user:a,contexts:d,level:c,fingerprint:l=[],propagationContext:w}=s||{};return this._tags={...this._tags,...i},this._attributes={...this._attributes,...o},this._extra={...this._extra,...r},this._contexts={...this._contexts,...d},a&&Object.keys(a).length&&(this._user=a),c&&(this._level=c),l.length&&(this._fingerprint=l),w&&(this._propagationContext=w),this}clear(){return this._breadcrumbs=[],this._tags={},this._attributes={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,le(this,void 0),this._attachments=[],this.setPropagationContext({traceId:ce(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(e,t){const s=typeof t=="number"?t:We;if(s<=0)return this;const i={timestamp:oe(),...e,message:e.message?Fe(e.message,2048):e.message};return this._breadcrumbs.push(i),this._breadcrumbs.length>s&&(this._breadcrumbs=this._breadcrumbs.slice(-s),this._client?.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,attributes:this._attributes,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:de(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=ae(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,t){const s=t?.event_id||k();if(!this._client)return v&&I.warn("No client configured on scope - will not capture exception!"),s;const i=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:i,...t,event_id:s},this),s}captureMessage(e,t,s){const i=s?.event_id||k();if(!this._client)return v&&I.warn("No client configured on scope - will not capture message!"),i;const o=s?.syntheticException??new Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:o,...s,event_id:i},this),i}captureEvent(e,t){const s=t?.event_id||k();return this._client?(this._client.captureEvent(e,{...t,event_id:s},this),s):(v&&I.warn("No client configured on scope - will not capture event!"),s)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}function Ye(){return N("defaultCurrentScope",()=>new m)}function Qe(){return N("defaultIsolationScope",()=>new m)}class Xe{constructor(e,t){let s;e?s=e:s=new m;let i;t?i=t:i=new m,this._stack=[{scope:s}],this._isolationScope=i}withScope(e){const t=this._pushScope();let s;try{s=e(t)}catch(i){throw this._popScope(),i}return $e(s)?s.then(i=>(this._popScope(),i),i=>{throw this._popScope(),i}):(this._popScope(),s)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function D(){const n=te(),e=M(n);return e.stack=e.stack||new Xe(Ye(),Qe())}function Ze(n){return D().withScope(n)}function et(n,e){const t=D();return t.withScope(()=>(t.getStackTop().scope=n,e(n)))}function ue(n){return D().withScope(()=>n(D().getIsolationScope()))}function tt(){return{withIsolationScope:ue,withScope:Ze,withSetScope:et,withSetIsolationScope:(n,e)=>ue(e),getCurrentScope:()=>D().getScope(),getIsolationScope:()=>D().getIsolationScope()}}function st(n){const e=M(n);return e.acs?e.acs:tt()}function it(){const n=te();return st(n).getCurrentScope()}function Ct(n){}function nt(n,e){return it().captureException(n,void 0)}class he{constructor(e){this.apiClient=e}async init(e){return this.apiClient.post("/v1/configs/get-init",e)}async fetch(e){return this.apiClient.post("/v1/configs/get-fetch",e)}}class ge{constructor(e){this.apiClient=e}async getAll(){return this.apiClient.get("/v1/ab-tests")}async getActive(){return this.apiClient.get("/v1/ab-tests/active")}async getById(e){return this.apiClient.get(`/v1/ab-tests/${e}`)}async getVariant(e){return this.apiClient.get(`/v1/ab-tests/${e}/variant`)}async create(e){return this.apiClient.post("/v1/ab-tests",e)}async update(e,t){return this.apiClient.request(`/v1/ab-tests/${e}`,{method:"PUT",body:JSON.stringify(t)})}async patch(e,t){return this.apiClient.request(`/v1/ab-tests/${e}`,{method:"PATCH",body:JSON.stringify(t)})}async delete(e){return this.apiClient.request(`/v1/ab-tests/${e}`,{method:"DELETE"})}}class fe{constructor(e){this.apiClient=e}async getAll(){return this.apiClient.get("/v1/remote-configs")}async getById(e){return this.apiClient.get(`/v1/remote-configs/${e}`)}async create(e){return this.apiClient.post("/v1/remote-configs",e)}async update(e,t){return this.apiClient.request(`/v1/remote-configs/${e}`,{method:"PATCH",body:JSON.stringify(t)})}async delete(e){return this.apiClient.request(`/v1/remote-configs/${e}`,{method:"DELETE"})}async refresh(){return this.apiClient.post("/v1/remote-configs/refresh",{})}}class pe{constructor(e){this.apiClient=e}async getAll(){return this.apiClient.get("/v1/segments")}async getById(e){return this.apiClient.get(`/v1/segments/${e}`)}async getUserSegments(){return this.apiClient.get("/v1/segments/user")}async create(e){return this.apiClient.post("/v1/segments",e)}async update(e,t){return this.apiClient.request(`/v1/segments/${e}`,{method:"PATCH",body:JSON.stringify(t)})}async delete(e){return this.apiClient.request(`/v1/segments/${e}`,{method:"DELETE"})}}class me{constructor(e){this.getAuthToken=e}buildUrl(e){const t=f.authUrl.replace(/\/+$/,""),s=e.replace(/^\/+/,"");return`${t}/${s}`}async request(e,t={}){const s=this.buildUrl(e),i=this.getAuthToken(),o={"Content-Type":"application/json",...t.headers};i&&(o.Authorization=`Bearer ${i}`);const r=await fetch(s,{...t,headers:o,credentials:"include"});if(!r.ok){const d=await r.text();let c=`Request failed with status ${r.status}`;try{const l=JSON.parse(d);Array.isArray(l.message)?c=l.message.join(", "):l.message?c=l.message:l.error&&(c=l.error)}catch{}throw new Error(c)}const a=await r.text();return a?JSON.parse(a):null}async getAll(){return this.request("/v1/users")}async getById(e){return this.request(`/v1/users/${e}`)}async search(e){return this.request(`/v1/users/search?q=${encodeURIComponent(e)}`)}async create(e){return this.request("/v1/users",{method:"POST",body:JSON.stringify(e)})}async update(e,t){return this.request(`/v1/users/${e}`,{method:"PATCH",body:JSON.stringify(t)})}async delete(e){return this.request(`/v1/users/${e}`,{method:"DELETE"})}}class ye{constructor(e){this.apiClient=e}async getVersion(){return this.apiClient.get("/v1")}async check(){return this.apiClient.get("/v1/health")}async detailed(){return this.apiClient.get("/v1/health/detailed")}}class Se{constructor(e){this.getAuthToken=e}buildUrl(e){const t=f.authUrl.replace(/\/+$/,""),s=e.replace(/^\/+/,"");return`${t}/${s}`}async request(e,t={}){const s=this.buildUrl(e);let i=this.getAuthToken();!i&&typeof localStorage<"u"&&(i=localStorage.getItem("coreSDK_token")||void 0);const o={"Content-Type":"application/json",...t.headers};i&&(o.Authorization=`Bearer ${i}`);const r=await fetch(s,{...t,headers:o,credentials:"include"});if(!r.ok){const d=await r.text();let c=`Request failed with status ${r.status}`;try{const l=JSON.parse(d);Array.isArray(l.message)?c=l.message.join(", "):l.message&&(c=l.message)}catch{}throw new Error(c)}const a=await r.text();return a?JSON.parse(a):null}async init(e){return this.request("/v1/auth/init",{method:"POST",body:JSON.stringify(e)})}async signin(e){return this.request("/v1/auth/signin",{method:"POST",body:JSON.stringify(e)})}async confirmCode(e){return this.request("/v1/auth/code",{method:"POST",body:JSON.stringify(e)})}async logout(){try{await this.request("/v1/auth/logout",{method:"POST"})}catch{}}async getOAuthConfig(){return this.request("/v1/auth/oauth/config",{method:"GET"})}async googleSignIn(e,t){return this.init({...t,et:e,pr:"google"})}async health(){return this.request("/v1/health",{method:"GET"})}}class we{constructor(e){this.getAuthToken=e}buildUrl(e){const t=f.configUrl.replace(/\/+$/,""),s=e.replace(/^\/+/,"");return`${t}/${s}`}async request(e,t={}){const s=this.buildUrl(e),i=this.getAuthToken(),o={"Content-Type":"application/json",...t.headers};i&&(o.Authorization=`Bearer ${i}`);const r=await fetch(s,{...t,headers:o,credentials:"include"});if(!r.ok){const d=await r.text();let c=`Request failed with status ${r.status}`;try{const l=JSON.parse(d);Array.isArray(l.message)?c=l.message.join(", "):l.message&&(c=l.message)}catch{}throw new Error(c)}const a=await r.text();return a?JSON.parse(a):null}async list(e){const t=e?`?pattern=${encodeURIComponent(e)}`:"";return this.request(`/v1/player-kv/list${t}`,{method:"GET"})}async get(e){return this.request(`/v1/player-kv/get/${encodeURIComponent(e)}`,{method:"GET"})}async set(e,t,s){return this.request("/v1/player-kv/set",{method:"POST",body:JSON.stringify({key:e,value:t,ttl:s})})}async delete(e){return this.request(`/v1/player-kv/${encodeURIComponent(e)}`,{method:"DELETE"})}async exists(e){return this.request(`/v1/player-kv/exists/${encodeURIComponent(e)}`,{method:"GET"})}async getMany(e){const t={},s=e.map(async i=>{try{const o=await this.get(i);t[i]=o.value}catch{t[i]=null}});return await Promise.all(s),t}async setMany(e,t){const s=Object.entries(e).map(([i,o])=>this.set(i,o,t));await Promise.all(s)}async deleteMany(e){const t=e.map(s=>this.delete(s));await Promise.all(t)}}class ot{constructor(e){this.apiClient=e}async getAll(){return this.apiClient.get("/v1/events")}async send(e){return this.apiClient.post("/v1/events",e)}}const K="1.0.80",x=[K,"1.0.3","1.0.0"];function be(n){return x.includes(n)}function ve(n){if(!be(n)){const e=x.join(", ");throw new Error(`[SDK] Unsupported version "${n}". Supported versions: ${e}. Current SDK version: ${K}`)}}class rt{constructor(e){this.getAuthToken=e}buildUrl(e){const t=(f.profileUrl||f.configUrl).replace(/\/+$/,""),s=e.replace(/^\/+/,"");return`${t}/${s}`}async request(e,t={}){const s=this.buildUrl(e),i=this.getAuthToken(),o={"Content-Type":"application/json",...t.headers};i&&(o.Authorization=`Bearer ${i}`);const r=await fetch(s,{...t,headers:o});if(!r.ok){const d=await r.text();let c=`Request failed with status ${r.status}`;try{const l=JSON.parse(d);l.message&&(c=l.message)}catch{}throw new Error(c)}const a=await r.text();return a?JSON.parse(a):null}async get(){return this.request("/v1/state",{method:"GET"})}async update(e){return this.request("/v1/state",{method:"PUT",body:JSON.stringify({meta:e})})}async getProfile(){return this.request("/v1/profile",{method:"GET"})}async updateProfile(e){return this.request("/v1/profile",{method:"PATCH",body:JSON.stringify(e)})}async getField(e){return this.request(`/v1/profile/field/${e}`,{method:"GET"})}async setField(e,t){return this.request(`/v1/profile/field/${e}`,{method:"PUT",body:JSON.stringify({value:t})})}async kvList(){return this.request("/v1/kv/list",{method:"GET"})}async kvGet(e){return this.request(`/v1/kv/${e}`,{method:"GET"})}async kvSet(e,t,s){await this.request("/v1/kv/set",{method:"POST",body:JSON.stringify({key:e,value:t,ttl:s})})}async kvDelete(e){return this.request(`/v1/kv/${e}`,{method:"DELETE"})}async kvExists(e){return this.request(`/v1/kv/exists/${e}`,{method:"GET"})}}class J{constructor(e,t){this.response=e,this.configs=t}get(e){const t=this.parsePath(e);if(t.length===0)return;const[s,...i]=t;let o=this.configs[s];for(const r of i){if(o==null)return;o=o[r]}return o}has(e){return this.get(e)!==void 0}keys(){const e=[];for(const t of Object.keys(this.configs))for(const s of Object.keys(this.configs[t]))e.push(`${t}.${s}`);return e}values(){const e=[];for(const t of Object.values(this.configs))for(const s of Object.values(t))e.push(s);return e}getAll(){return this.configs}getScope(e){return this.configs[e]}getMeta(){return{segment:this.response.segment,ab:this.response.ab,abG:this.response.abG,abExp:this.response.abExp}}raw(){return this.response}parsePath(e){return e.split(/\.|\[|\]/).filter(Boolean).map(t=>{const s=parseInt(t,10);return isNaN(s)?t:s})}}const De={},Ae=(n,e)=>{De[n]=e},at=n=>De[n]?.(),Ce=()=>typeof window<"u"&&typeof navigator<"u",ct=()=>Ce()&&navigator.userAgent||"",lt=n=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(n),dt=()=>{if(!Ce())return{env:"unknown"};const n=window,e=ct(),t=n?.cordova,s=typeof t?.platformId=="string"?t.platformId:void 0;return t?s==="ios"?{env:"cordova-ios",platformId:s,userAgent:e}:s==="android"?{env:"cordova-android",platformId:s,userAgent:e}:{env:"unknown",platformId:s,userAgent:e}:{env:lt(e)?"web-mobile":"web-desktop",userAgent:e}},_e=n=>{const e=n?.get?.("ads")??null;if(!e||typeof e!="object")return null;const t=!!e.enabled,s=e.placements;return!s||typeof s!="object"?null:{enabled:t,defaults:e.defaults,mediators:e.mediators,placements:s}},U=n=>n==="cordova-ios"||n==="cordova-android"?"cordova":n==="web-mobile"||n==="web-desktop"?"web":null,ut=(n,e)=>({placement:n,type:e,isReady:!1,isLoading:!1,readyTime:null,lastLoadStartTime:null,lastShowTime:null,retryCount:0,lastErrorCode:null,lastErrorMessage:null,stats:{totalLoads:0,successfulLoads:0,totalShows:0,totalRewards:0}}),ht=(n,e,t)=>n==="linear"?t*e:n==="exponential"?t*Math.pow(2,e-1):0,gt=(n,e,t)=>{let s;return Promise.race([n,new Promise((i,o)=>{s=setTimeout(()=>o(t),e)})]).finally(()=>clearTimeout(s))},ft=(n,e)=>{if(n.isReady)return Promise.resolve(!0);const t=Date.now();return new Promise(s=>{const i=()=>{if(n.isReady)return s(!0);if(Date.now()-t>=e)return s(!1);setTimeout(i,100)};i()})},Ee=n=>{try{return JSON.stringify(n??{})}catch{return""}};class pt{constructor(e){this.deps=e,this.enabled=!1,this.mediators=new Map,this.environment="unknown",this.placements=new Map,this.showingPlacement=null,this.adsConfig=null,this.mediatorsConfigHash=null,this.mediatorInitPromises=new Map;const t=e.eventBus;t&&(typeof t.emit=="function"&&(t.emit=t.emit.bind(t)),typeof t.on=="function"&&(t.on=t.on.bind(t)),typeof t.once=="function"&&(t.once=t.once.bind(t)),typeof t.off=="function"&&(t.off=t.off.bind(t)))}async init(){const{env:e,platformId:t,userAgent:s}=dt();this.environment=e,this.deps.logger?.info?.("[AdManager] init start",{env:e,platformId:t,userAgent:s}),this.deps.eventBus?.emit?.("ads.init.start",{env:e});const i=_e(this.deps.configService);if(this.adsConfig=i,!i){this.enabled=!1,this.deps.logger?.warn?.("[AdManager] ads config missing"),this.deps.eventBus?.emit?.("ads.init.failed",{env:e,reason:"NO_CONFIG"});return}if(!i.enabled){this.enabled=!1,this.deps.logger?.info?.("[AdManager] ads disabled by config"),this.deps.eventBus?.emit?.("ads.init.failed",{env:e,reason:"DISABLED"});return}const o=U(this.environment);if(!o){this.enabled=!1,this.deps.logger?.warn?.("[AdManager] unknown environment branch",{env:this.environment}),this.deps.eventBus?.emit?.("ads.init.failed",{env:e,reason:"UNKNOWN_ENV"});return}this.mediatorsConfigHash=Ee(i.mediators),this.enabled=!0;const r=this.getMediatorsForBranch(i,o);this.deps.logger?.info?.("[AdManager] ads enabled",{env:e,branch:o,mediators:r}),this.deps.eventBus?.emit?.("ads.init.success",{env:e,branch:o,mediators:r}),this.deps.eventBus?.on?.("config.updated",()=>{this.onConfigUpdated()});for(const[a,d]of Object.entries(i.placements))this.getPlacementState(a,d.type);if(i.defaults?.preloadOnStart)for(const[a,d]of Object.entries(i.placements))this.preloadPlacement(a,d).catch(c=>{this.deps.logger?.warn?.("[AdManager] preload failed",{placement:a,err:c})})}onConfigUpdated(){const e=_e(this.deps.configService);if(!e){this.enabled=!1,this.adsConfig=null,this.deps.eventBus?.emit?.("ads.config.updated",{enabled:!1});return}const t=Ee(e.mediators);if(this.mediatorsConfigHash!==t){this.deps.logger?.info?.("[AdManager] mediators config changed, resetting");for(const i of this.mediators.values())i.destroy?.();this.mediators.clear(),this.mediatorsConfigHash=t}if(this.adsConfig=e,this.mediatorInitPromises.clear(),!e.enabled){this.enabled=!1,this.deps.eventBus?.emit?.("ads.config.updated",{enabled:!1});return}if(!U(this.environment)){this.enabled=!1,this.deps.eventBus?.emit?.("ads.config.updated",{enabled:!1});return}this.enabled=!0;for(const i of this.placements.keys())e.placements[i]||this.placements.delete(i);for(const[i,o]of Object.entries(e.placements))this.placements.has(i)||(this.getPlacementState(i,o.type),e.defaults?.preloadOnStart&&this.preloadPlacement(i,o).catch(()=>{}));this.deps.eventBus?.emit?.("ads.config.updated",{enabled:!0})}getMediatorsForBranch(e,t){const s=new Set;for(const i of Object.values(e.placements)){const o=i?.[t]?.mediator;o&&s.add(o)}return Array.from(s)}async getMediatorForPlacement(e,t){const s=U(this.environment);if(!s)return null;const o=t?.[s]?.mediator;if(!o)return null;let r=this.mediators.get(o);if(r)return r;let a=this.mediatorInitPromises.get(o);return a||(a=(async()=>{const d=at(o);if(!d)throw new Error("MEDIATOR_NOT_REGISTERED");return await d.init(this.adsConfig,this.environment),this.mediators.set(o,d),this.mediatorInitPromises.delete(o),d})(),this.mediatorInitPromises.set(o,a)),a}async showAd(e,t,s){const i=Date.now(),o=this.adsConfig,r=o?.placements?.[t];if(this.deps.eventBus?.emit?.("ads.show.request",{placement:t,type:e}),console.group(`[ADS][showAd] ${t} (${e})`),console.log("[ADS] enabled:",this.enabled),console.log("[ADS] adsConfig:",o),console.log("[ADS] placementConfig:",r),!o||!this.enabled){const g={status:"SDK_DISABLED",type:e,placement:t,canReward:!1,timestamp:i};return console.warn("[ADS] SDK disabled"),s?.(g),this.deps.eventBus?.emit?.("ads.show.failed",g),console.groupEnd(),g}const a=U(this.environment),d=a?r?.[a]:null;if(!r||r.type!==e||!d?.mediator){const g={status:"NO_CONFIG",type:e,placement:t,canReward:!1,timestamp:i};return console.warn("[ADS] NO_CONFIG for placement"),s?.(g),this.deps.eventBus?.emit?.("ads.show.failed",g),console.groupEnd(),g}let c=await this.getMediatorForPlacement(t,r);if(console.group("[ADS][DEBUG] mediator raw"),console.log("mediator:",c),console.log("typeof:",typeof c),console.groupEnd(),typeof c=="function"&&(console.warn("[ADS][DEBUG] mediator is function → invoking"),c=c()),c instanceof Promise&&(console.warn("[ADS][DEBUG] mediator is Promise → awaiting"),c=await c),console.group("[ADS][DEBUG] mediator resolved"),console.log("mediator:",c),console.log("typeof:",typeof c),console.log("keys:",c?Object.keys(c):null),console.log("has init:",typeof c?.init),console.log("has load:",typeof c?.load),console.log("has show:",typeof c?.show),console.log("proto:",c?Object.getPrototypeOf(c):null),console.groupEnd(),!c||typeof c.show!="function"){const g={status:"INTERNAL_ERROR",type:e,placement:t,canReward:!1,errorMessage:"Mediator.show is not a function",timestamp:Date.now()};return console.error("[ADS][FATAL] mediator.show missing",c),s?.(g),console.groupEnd(),g}if(this.showingPlacement){const g={status:"SHOW_FAILED",type:e,placement:t,canReward:!1,errorMessage:"Ad already showing",timestamp:i};return console.warn("[ADS] Ad already showing"),s?.(g),this.deps.eventBus?.emit?.("ads.show.failed",g),console.groupEnd(),g}const l=this.getPlacementState(t,e),w=o?.defaults?.loadTimeoutMs??15e3;if(console.log("[ADS] state before show:",l),!l.isReady&&(console.warn("[ADS] not ready → preload"),this.preloadPlacement(t,r).catch(()=>{}),!await ft(l,w))){const C={status:"NOT_READY",type:e,placement:t,canReward:!1,errorCode:"LOAD_TIMEOUT",errorMessage:`Ad not ready after ${w}ms`,timestamp:Date.now()};return console.warn("[ADS] NOT_READY timeout"),s?.(C),this.deps.eventBus?.emit?.("ads.show.failed",C),console.groupEnd(),C}this.showingPlacement=t,l.lastShowTime=Date.now(),l.stats.totalShows++,console.log("[ADS] showingPlacement set:",t);const z=o?.defaults?.showTimeoutMs??15e3;return new Promise(g=>{let C=!1;const V=b=>{if(C)return;C=!0,this.showingPlacement=null,e!=="banner"&&(l.isReady=!1);const h={...b,type:e,placement:t,timestamp:Date.now()};typeof h.canReward!="boolean"&&(h.canReward=h.status==="REWARD_GRANTED"),h.canReward&&(h.rewardType==null&&(h.rewardType=r.rewardType??null),h.rewardAmount==null&&(h.rewardAmount=r.rewardAmount??null),l.stats.totalRewards++),console.log("[ADS] finish:",h),h.status==="REWARD_GRANTED"?(this.deps.eventBus?.emit?.("ads.reward.granted",{placement:t,type:e,rewardType:h.rewardType??null,rewardAmount:h.rewardAmount??null}),this.deps.eventBus?.emit?.("ads.show.completed",h)):h.status==="COMPLETED"?this.deps.eventBus?.emit?.("ads.show.completed",h):h.status==="CANCELLED"?this.deps.eventBus?.emit?.("ads.show.closed",h):this.deps.eventBus?.emit?.("ads.show.failed",h),s?.(h),g(h),this.preloadPlacement(t,r).catch(()=>{}),console.groupEnd()},Te=setTimeout(()=>{console.warn("[ADS] SHOW TIMEOUT"),V({status:"TIMEOUT",type:e,placement:t,canReward:!1,timestamp:Date.now()})},z);try{console.log("[ADS] calling mediator.show()"),this.deps.eventBus?.emit?.("ads.show.start",{placement:t,type:e}),c.show(e,t,r,b=>{clearTimeout(Te),console.log("[ADS] mediator result:",b),V(b)})}catch(b){clearTimeout(Te),console.error("[ADS][ERROR] mediator.show exception",b),V({status:"INTERNAL_ERROR",type:e,placement:t,canReward:!1,errorMessage:String(b),timestamp:Date.now()})}})}getPlacementState(e,t){let s=this.placements.get(e);return s||(s=ut(e,t),this.placements.set(e,s)),s}async preloadPlacement(e,t){const s=this.getPlacementState(e,t.type),i=this.adsConfig;if(i&&!s.isReady)return s.isLoading&&s.loadPromise||(s.isLoading=!0,s.lastLoadStartTime=Date.now(),s.stats.totalLoads++,this.deps.eventBus?.emit?.("ads.placement.preload.start",{placement:e}),s.loadPromise=(async()=>{const o=i.defaults?.retry,r=o?.strategy??"none",a=o?.maxAttempts??0,d=o?.baseDelayMs??0,c=i.defaults?.loadTimeoutMs??15e3;for(;;)try{const l=await this.getMediatorForPlacement(e,t);if(!l)throw new Error("NO_MEDIATOR");await gt(l.load(t.type,e,t),c,new Error("LOAD_TIMEOUT")),s.isReady=!0,s.retryCount=0,s.readyTime=Date.now(),s.stats.successfulLoads++,this.deps.eventBus?.emit?.("ads.placement.preload.success",{placement:e});return}catch(l){if(s.retryCount++,s.lastErrorCode=l?.code??"LOAD_FAILED",s.lastErrorMessage=l?.message??"Ad load failed",this.deps.eventBus?.emit?.("ads.placement.preload.failed",{placement:e,errorCode:s.lastErrorCode,errorMessage:s.lastErrorMessage}),s.retryCount>a||r==="none")return;const w=ht(r,s.retryCount,d);await new Promise(z=>setTimeout(z,w))}})().finally(()=>{s.isLoading=!1,s.loadPromise=null})),s.loadPromise}}class mt{constructor(){this.store=new Map}get(e){if(this.store.has(e))return this.store.get(e);const t=e.split(".").filter(Boolean);if(t.length<=1)return null;const[s,...i]=t,o=this.store.get(s);if(!o||typeof o!="object")return null;let r=o;for(const a of i){if(r==null||typeof r!="object")return null;r=r[a]}return r??null}set(e,t){this.store.set(e,t)}replace(e){this.store.clear();for(const[t,s]of Object.entries(e))this.store.set(t,s)}}const y={AUTH_SUCCESS:"core:authSuccess",AUTH_ERROR:"core:authError"},R={ios:1,android:2,web:3,windows:3,macos:3,linux:3,unknown:3};class S{constructor(){this.eventBus=new X,this.systemParams={},this.initialized=!1,this.oauthConfig=null,this.configState={configs:{}},this.ads={registerMediator:Ae},this.detectEnvironment();try{const e=localStorage.getItem("coreSDK_token");e&&(this.systemParams.authToken=e,console.log("[SDK] constructor: restored token from localStorage"));const t=localStorage.getItem("coreSDK_configUrl"),s=localStorage.getItem("coreSDK_authUrl"),i=localStorage.getItem("coreSDK_profileUrl");t&&(O(t),console.log("[SDK] constructor: restored configUrl from localStorage")),s&&(G(s),console.log("[SDK] constructor: restored authUrl from localStorage")),i&&(W(i),console.log("[SDK] constructor: restored profileUrl from localStorage"))}catch(e){console.error("[SDK] constructor: failed to restore state:",e)}this.apiClient=new Q(()=>this.systemParams.authToken),this.configs=new he(this.apiClient),this.abTests=new ge(this.apiClient),this.remoteConfigs=new fe(this.apiClient),this.segments=new pe(this.apiClient),this.users=new me(()=>this.systemParams.authToken),this.health=new ye(this.apiClient),this.auth=new Se(()=>this.systemParams.authToken),this.playerKv=new we(()=>this.systemParams.authToken),this.events=new ot(this.apiClient),this.profileClient=new P(()=>this.systemParams.authToken,this.eventBus),this.profileApi=new rt(()=>this.systemParams.authToken),this.gamestate=this.profileApi,this.configStore=new mt,this.adManager=new pt({configService:this.configStore,eventBus:this.eventBus,logger:console})}static getInstance(){return S.instance||(S.instance=new S),S.instance}async init(e,t){if(console.log(`[SDK] v${K} init: start`,e),e?.version){console.log(`[SDK] init: validating app version "${e.version}"...`);try{ve(e.version),console.log(`[SDK] init: app version "${e.version}" is supported`)}catch(i){throw console.error(`[SDK] init: VERSION ERROR - ${i.message}`),console.error(`[SDK] init: Supported versions: ${x.join(", ")}`),i}}if(this.initialized){console.log("[SDK] init: already initialized, skipping"),t&&this.isAuthenticated()&&(console.log("[SDK] init: already authenticated, calling onAuthReady"),t());return}e?.configUrl&&(console.log("[SDK] init: set base url ->",e.configUrl),O(e.configUrl),this.storeUrl("coreSDK_configUrl",e.configUrl)),e?.authUrl&&(console.log("[SDK] init: set auth url ->",e.authUrl),G(e.authUrl),this.storeUrl("coreSDK_authUrl",e.authUrl)),e?.profileUrl&&(console.log("[SDK] init: set profile url ->",e.profileUrl),W(e.profileUrl),this.storeUrl("coreSDK_profileUrl",e.profileUrl));const s=this.getStoredToken();if(s){console.log("[SDK] init: restoring token from localStorage"),this.systemParams.authToken=s,this.profileClient=new P(()=>this.systemParams.authToken,this.eventBus),this.initialized=!0,console.log("[SDK] init: restored session, SDK ready"),t&&(console.log("[SDK] init: calling onAuthReady after token restore"),t());return}if(this.systemParams.authToken){console.log("[SDK] init: token already set, SDK ready"),this.profileClient=new P(()=>this.systemParams.authToken,this.eventBus),this.initialized=!0,t&&(console.log("[SDK] init: calling onAuthReady (token already set)"),t());return}try{console.log("[SDK] init: set system params ->",e),e&&this.setSystemParams(e),console.log("[SDK] init: ensure device id…");const i=await this.ensureDeviceId();console.log("[SDK] init: deviceId =",i),this.systemParams.deviceId=i,e?.skipAuth?console.log("[SDK] init: skipAuth=true, skipping auth"):this.isAuthenticated()?console.log("[SDK] init: already authenticated, skipping auth modal"):(console.log("[SDK] init: showing auth modal…"),await this.showAuthModal(),console.log("[SDK] init: auth completed")),this.profileClient=new P(()=>this.systemParams.authToken,this.eventBus),console.log("[SDK] init: profile module initialized"),this.on(B.PROFILE_UPDATED,o=>{try{const r=o?.gid??o?.detail?.gid;r&&(console.log("[SDK] profile cache invalidated for",r),this.profileClient.invalidate(r))}catch(r){console.error("[SDK] profile cache invalidation error:",r)}}),this.initialized=!0,console.log("[SDK] init: COMPLETE"),await this.initAds(),this.eventBus.emit("core:initialized",this.getSystemParams()),t&&this.isAuthenticated()&&(console.log("[SDK] init: calling onAuthReady after init"),t())}catch(i){throw console.error("[SDK] init: ERROR",i),this.captureError(i),i}}captureError(e){try{nt(e)}catch(t){console.error("[SDK] Sentry capture error:",t)}}showAuthModal(){return new Promise((e,t)=>{new ee({googleEnabled:!0,onGoogleClick:async()=>{try{if(await this.loadOAuthConfig(),!this.getGoogleClientId()){console.warn("[SDK] Google Client ID not configured, falling back to guest"),await this.loginAsGuest(),e();return}const{credential:o}=await this.getGoogleIdToken();await this.loginWithGoogle(o),e()}catch(i){console.error("[SDK] Google auth failed:",i),t(i)}},onGuestClick:async()=>{try{await this.loginAsGuest(),e()}catch(i){t(i)}},onClose:()=>{t(new Error("Auth cancelled by user"))}}).show()})}async loginAsGuest(){try{const t=!this.getStoredDeviceId();console.log(t?"[SDK] loginAsGuest: no deviceId found, registering new guest...":"[SDK] loginAsGuest: deviceId found, logging in existing guest...");const s=await this.ensureDeviceId(),i=R[this.systemParams.os||"web"]||3,o=this.systemParams.app||"default",r=this.getStoredToken();console.log("[SDK] loginAsGuest: calling /auth/init",{did:s,os:i,app:o,hasToken:!!r});const a=await this.auth.init({app:o,os:i,did:s,ln:this.getLanguage(),tk:r||void 0}),d=a?.jwt??null;if(!d)throw console.error("[SDK] loginAsGuest: ERROR missing jwt",a),new Error("Guest login failed: missing jwt token");return this.storeToken(d),this.storeAuthType("guest",a.an),this.systemParams.authToken=d,this.eventBus.emit(y.AUTH_SUCCESS,{type:"guest",isNewGuest:t,uid:a.uid,gid:a.gid,anonymous:a.an}),console.log(`[SDK] loginAsGuest: SUCCESS (${t?"registered":"logged in"})`,{uid:a.uid,gid:a.gid,anonymous:a.an}),a}catch(e){throw console.error("[SDK] loginAsGuest: ERROR",e),this.eventBus.emit(y.AUTH_ERROR,{error:e}),this.captureError(e),e}}async signinWithEmail(e){try{console.log("[SDK] signinWithEmail: start",{email:e});const t=R[this.systemParams.os||"web"]||3,s=this.systemParams.app||"default",i=await this.auth.signin({app:s,os:t,email:e,ln:this.getLanguage()});if("rid"in i)return console.log("[SDK] signinWithEmail: code sent, rid =",i.rid),{rid:i.rid};throw new Error("Unexpected response from signin")}catch(t){throw console.error("[SDK] signinWithEmail: ERROR",t),this.captureError(t),t}}async confirmCode(e,t){try{console.log("[SDK] confirmCode: start",{rid:e,code:t});const s=await this.auth.confirmCode({rid:e,code:t}),i=s?.jwt??null;if(!i)throw new Error("Code confirmation failed: missing jwt token");return this.storeToken(i),this.storeAuthType("email",s.an),this.systemParams.authToken=i,this.eventBus.emit(y.AUTH_SUCCESS,{type:"email",uid:s.uid,gid:s.gid,anonymous:s.an}),console.log("[SDK] confirmCode: SUCCESS",{uid:s.uid,gid:s.gid}),s}catch(s){throw console.error("[SDK] confirmCode: ERROR",s),this.captureError(s),s}}async signinWithProvider(e,t){try{console.log("[SDK] signinWithProvider: start",{provider:e});const s=R[this.systemParams.os||"web"]||3,i=this.systemParams.app||"default",o=await this.auth.signin({app:i,os:s,ln:this.getLanguage(),et:t,pr:e});if("rid"in o)throw new Error("Unexpected response: got rid instead of auth response");const r=o?.jwt??null;if(!r)throw new Error("Provider signin failed: missing jwt token");return this.storeToken(r),this.storeAuthType(e,o.an),this.systemParams.authToken=r,this.eventBus.emit(y.AUTH_SUCCESS,{type:e,uid:o.uid,gid:o.gid,anonymous:o.an}),console.log("[SDK] signinWithProvider: SUCCESS",{uid:o.uid,gid:o.gid}),o}catch(s){throw console.error("[SDK] signinWithProvider: ERROR",s),this.captureError(s),s}}async logout(){try{console.log("[SDK] logout: start"),this.clearToken(),this.clearAuthType(),this.systemParams.authToken=void 0,console.log("[SDK] logout: COMPLETE")}catch(e){throw console.error("[SDK] logout: ERROR",e),this.captureError(e),e}}setSystemParams(e){this.systemParams={...this.systemParams,...e}}getSystemParams(){const{isCordova:e,os:t,...s}=this.systemParams;return s}on(e,t){this.eventBus.on(e,t)}once(e,t){this.eventBus.once(e,t)}off(e,t){this.eventBus.off(e,t)}emit(e,...t){this.eventBus.emit(e,...t)}detectEnvironment(){const e=typeof navigator<"u"?navigator.userAgent:"",t=typeof window<"u"&&typeof window.cordova<"u";this.systemParams.os=this.detectOS(e),this.systemParams.isCordova=t}detectOS(e){return/android/i.test(e)?"android":/iPad|iPhone|iPod/i.test(e)?"ios":/Win/i.test(e)?"windows":/Mac/i.test(e)?"macos":/Linux/i.test(e)?"linux":"web"}getLanguage(){return typeof navigator<"u"&&navigator.language?navigator.language.split("-")[0]:"en"}async ensureDeviceId(){const e=this.getStoredDeviceId();if(e)return e;const t=await this.tryGetCordovaDeviceId();if(t)return this.storeDeviceId(t),t;const s=this.generateGuid();return this.storeDeviceId(s),s}getStoredDeviceId(){try{return localStorage.getItem("coreSDK_deviceId")}catch(e){return console.error("[SDK] getStoredDeviceId error:",e),null}}storeDeviceId(e){try{localStorage.setItem("coreSDK_deviceId",e)}catch(t){console.error("[SDK] storeDeviceId error:",t)}}getStoredToken(){try{return localStorage.getItem("coreSDK_token")}catch(e){return console.error("[SDK] getStoredToken error:",e),null}}storeToken(e){try{localStorage.setItem("coreSDK_token",e)}catch(t){console.error("[SDK] storeToken error:",t)}}clearToken(){try{localStorage.removeItem("coreSDK_token")}catch(e){console.error("[SDK] clearToken error:",e)}}storeAuthType(e,t){try{localStorage.setItem("coreSDK_authType",e),localStorage.setItem("coreSDK_isAnonymous",t?"true":"false")}catch(s){console.error("[SDK] storeAuthType error:",s)}}getStoredAuthType(){try{const e=localStorage.getItem("coreSDK_authType"),t=localStorage.getItem("coreSDK_isAnonymous")==="true";return{authType:e,isAnonymous:t}}catch(e){return console.error("[SDK] getStoredAuthType error:",e),{authType:null,isAnonymous:!1}}}clearAuthType(){try{localStorage.removeItem("coreSDK_authType"),localStorage.removeItem("coreSDK_isAnonymous")}catch(e){console.error("[SDK] clearAuthType error:",e)}}storeUrl(e,t){try{localStorage.setItem(e,t)}catch(s){console.error(`[SDK] storeUrl(${e}) error:`,s)}}async tryGetCordovaDeviceId(){if(typeof window>"u")return null;const t=window.device;return t?.uuid?String(t.uuid):null}generateGuid(){const e=()=>Math.floor((1+Math.random())*65536).toString(16).substring(1);return`${e()}${e()}-${e()}-${e()}-${e()}-${e()}${e()}${e()}`}get profile(){return this.profileClient}isAuthenticated(){return!!this.systemParams.authToken}isGuest(){const{authType:e,isAnonymous:t}=this.getStoredAuthType();return e==="guest"||t}getAuthStatus(){const e=this.isAuthenticated(),{authType:t,isAnonymous:s}=this.getStoredAuthType();return{isAuthenticated:e,authType:e?t:null,isAnonymous:e&&s}}async loadOAuthConfig(){if(this.oauthConfig)return this.oauthConfig;try{return console.log("[SDK] loadOAuthConfig: fetching..."),this.oauthConfig=await this.auth.getOAuthConfig(),console.log("[SDK] loadOAuthConfig: success",this.oauthConfig),this.oauthConfig}catch(e){return console.error("[SDK] loadOAuthConfig: ERROR",e),null}}getGoogleClientId(){return this.oauthConfig?.google?.clientId??null}async loginWithGoogle(e){try{console.log("[SDK] loginWithGoogle: start");const t=await this.ensureDeviceId(),s=R[this.systemParams.os||"web"]||3,i=this.systemParams.app||"default",o=await this.auth.googleSignIn(e,{app:i,os:s,did:t,ln:this.getLanguage()}),r=o?.jwt??null;if(!r)throw new Error("Google login failed: missing jwt token");return this.storeToken(r),this.storeAuthType("google",o.an),this.systemParams.authToken=r,this.eventBus.emit(y.AUTH_SUCCESS,{type:"google",uid:o.uid,gid:o.gid,anonymous:o.an}),console.log("[SDK] loginWithGoogle: SUCCESS",{uid:o.uid,gid:o.gid}),o}catch(t){throw console.error("[SDK] loginWithGoogle: ERROR",t),this.eventBus.emit(y.AUTH_ERROR,{error:t}),this.captureError(t),t}}async getGoogleIdToken(e){try{console.log("[SDK] getGoogleIdToken: start"),await this.loadOAuthConfig();const t=this.getGoogleClientId();if(!t)throw new Error("Google Client ID not configured. Check OAuth config.");await _.loadScript();const s=await _.requestToken(t,e);return console.log("[SDK] getGoogleIdToken: SUCCESS"),s}catch(t){throw console.error("[SDK] getGoogleIdToken: ERROR",t),this.captureError(t),t}}async initConfigs(e){try{console.log("[SDK] initConfigs:",e);const t=await this.configs.init({v:e.version,scopes:e.scopes,keys:e.keys,values:e.values,segment:e.segment,ab:this.configState.ab,abG:this.configState.abG,abExp:this.configState.abExp});return this.configState={segment:t.segment,ab:t.ab,abG:t.abG,abExp:t.abExp,configs:t.configs||{}},this.updateAdsConfigFromConfigs(this.configState.configs),console.log("[SDK] initConfigs: SUCCESS",{segment:t.segment,ab:t.ab,abG:t.abG}),new J(t,this.configState.configs)}catch(t){throw console.error("[SDK] initConfigs: ERROR",t),this.captureError(t),t}}async fetchConfigs(e){try{console.log("[SDK] fetchConfigs:",e);const t=await this.configs.fetch({v:e.version,segment:this.configState.segment,scopes:e.scopes,keys:e.keys,values:e.values});return t.configs&&(this.configState.configs={...this.configState.configs,...t.configs}),this.updateAdsConfigFromConfigs(this.configState.configs),console.log("[SDK] fetchConfigs: SUCCESS",{scopes:Object.keys(t.configs||{})}),new J(t,this.configState.configs)}catch(t){throw console.error("[SDK] fetchConfigs: ERROR",t),this.captureError(t),t}}getConfig(e,t){return this.configState.configs[e]?.[t]}getConfigsByScope(e){return this.configState.configs[e]}getSegment(){return this.configState.segment}getABTest(){return{ab:this.configState.ab,abG:this.configState.abG,abExp:this.configState.abExp}}updateAdsConfigFromConfigs(e){const t=e?.ads;let s=t&&typeof t=="object"?t:null;if(!s)for(const i of Object.values(e)){const o=i?.ads;if(o&&typeof o=="object"){s=o;break}}this.configStore.set("ads",s??null),this.eventBus.emit("config.updated",{key:"ads",hasAds:!!s})}showAd(e,t,s){return this.adManager.showAd(e,t,s)}async initAds(){await this.adManager.init()}__setConfigForTests(e,t){this.configStore.set(e,t),this.eventBus.emit("config.updated",{key:e,hasAds:e==="ads"&&!!t})}__setAdsMediatorForTests(e,t){Ae(e,t)}}const ke=S.getInstance(),A=[{name:"core",description:"Core SDK initialization",methods:[{name:"init",description:"Initialize SDK with config",enabled:!0,example:`await coreSDK.init({
                  app: "test-frontend",
                  configUrl: "http://localhost:3000",
                  authUrl: "http://localhost:3001",
                  profileUrl: "http://localhost:3002",
                  version: "1.0.0",
                    skipAuth: false
                }, () => {
                  console.log("SDK initialized and authenticated!");
                });`},{name:"getSystemParams",description:"Get current system parameters",enabled:!0,example:`const params = coreSDK.getSystemParams();
// { app, version, deviceId, authToken, ... }`},{name:"isAuthenticated",description:"Check if user is authenticated",enabled:!0,example:"const isAuth = coreSDK.isAuthenticated();"},{name:"setSystemParams",description:"Set system parameters (app, version, etc.)",enabled:!0,example:'coreSDK.setSystemParams({ app: "my-game", version: "2.0.0" });'},{name:"isGuest",description:"Check if current user is a guest",enabled:!0,example:"const isGuest = coreSDK.isGuest();"},{name:"on",description:"Subscribe to SDK events",enabled:!0,example:`coreSDK.on("auth:login", (user) => console.log("Logged in:", user));
coreSDK.on("auth:logout", () => console.log("Logged out"));
coreSDK.on("profile:updated", (profile) => console.log("Profile updated"));`},{name:"once",description:"Subscribe to SDK event (fires once)",enabled:!0,example:'coreSDK.once("core:initialized", () => console.log("SDK ready"));'},{name:"off",description:"Unsubscribe from SDK events",enabled:!0,example:`const handler = (user) => console.log(user);
coreSDK.on("auth:login", handler);
coreSDK.off("auth:login", handler);`}]},{name:"auth",description:"Authentication methods",methods:[{name:"loginAsGuest",description:"Login as guest user",enabled:!0,example:"await coreSDK.loginAsGuest();"},{name:"loginWithGoogle",description:"Login with Google OAuth",enabled:!0,example:`const { credential } = await coreSDK.getGoogleIdToken();
await coreSDK.loginWithGoogle(credential);`},{name:"getGoogleIdToken",description:"Get Google ID Token for custom Sign-In UI",enabled:!0,example:"const { credential, select_by } = await coreSDK.getGoogleIdToken();"},{name:"logout",description:"Logout current user",enabled:!0,example:"await coreSDK.logout();"},{name:"getAuthStatus",description:"Get authentication status and type",enabled:!0,example:`const status = coreSDK.getAuthStatus();
// { isAuthenticated: true, authType: "google", isAnonymous: false }`},{name:"signinWithEmail",description:"Sign in with email (sends verification code)",enabled:!0,example:`await coreSDK.signinWithEmail("user@example.com");
// Sends verification code to email`},{name:"confirmCode",description:"Confirm verification code from email",enabled:!0,example:`const result = await coreSDK.confirmCode("123456");
// { accessToken, refreshToken, user }`},{name:"signinWithProvider",description:"Sign in with external provider",enabled:!0,example:'await coreSDK.signinWithProvider("google", { idToken: "..." });'}]},{name:"configs",description:"Configs API (segments, A/B tests, filters)",methods:[{name:"sdk.initConfigs",description:"Initialize configs with segment and A/B test assignment",enabled:!0,example:`const response = await coreSDK.initConfigs({
  version: "1.0.0",
  scopes: ["gameplay", "ui"],
  values: { isPremium: false, country: "US", level: 10 }
});
// Returns: { segment, ab, abG, abExp, configs }`},{name:"sdk.fetchConfigs",description:"Fetch configs by scopes with MongoDB-style filters",enabled:!0,example:`const response = await coreSDK.fetchConfigs({
  version: "1.0.0",
  scopes: ["monetization", "gameplay"],
  values: { isPremium: true, level: 50 }
});
// Filters: $eq, $ne, $gt, $gte, $lt, $lte, $in, $nin`},{name:"sdk.getConfig",description:"Get specific config value by scope and key",enabled:!0,example:'const maxLives = coreSDK.getConfig("gameplay", "maxLives");'},{name:"sdk.getConfigsByScope",description:"Get all configs in a scope",enabled:!0,example:'const uiConfigs = coreSDK.getConfigsByScope("ui");'},{name:"sdk.getConfigState",description:"Get current segment and A/B test state",enabled:!0,example:`// Get user segment
const segment = coreSDK.getSegment(); // "premium" | undefined

// Get A/B test assignment
const { ab, abG, abExp } = coreSDK.getABTest();
// ab = test key, abG = group key, abExp = expiration timestamp`},{name:"configResult.get",description:"Get config value by path (supports nested access)",enabled:!0,example:`const configs = await coreSDK.initConfigs({ version: '1.0.0', scopes: ['gameplay'] });

// Simple path
configs.get('gameplay.maxLives');           // 3

// Array access
configs.get('gameplay.items[0].name');      // "sword"

// Nested object
configs.get('gameplay.rewards.daily');      // { coins: 100 }

// Typed result
configs.get<number>('gameplay.maxLives');   // 3 (typed)`},{name:"configResult.has",description:"Check if config path exists",enabled:!0,example:`const configs = await coreSDK.initConfigs({ version: '1.0.0', scopes: ['gameplay'] });

configs.has('gameplay.maxLives');    // true
configs.has('gameplay.notExists');   // false`},{name:"configResult.keys",description:"Get all config keys in flat format",enabled:!0,example:`const configs = await coreSDK.initConfigs({ version: '1.0.0', scopes: ['gameplay', 'ui'] });

configs.keys();
// ['gameplay.maxLives', 'gameplay.items', 'ui.theme', 'ui.colors']`},{name:"configResult.values",description:"Get all config values",enabled:!0,example:`const configs = await coreSDK.initConfigs({ version: '1.0.0', scopes: ['gameplay', 'ui'] });

configs.values();
// [3, [...], 'dark', { primary: '#000' }]`},{name:"configResult.getScope",description:"Get all configs for a specific scope",enabled:!0,example:`const configs = await coreSDK.initConfigs({ version: '1.0.0', scopes: ['gameplay', 'ui'] });

configs.getScope('gameplay');
// { maxLives: 3, items: [...], rewards: { daily: { coins: 100 } } }`},{name:"configResult.getAll",description:"Get all configs grouped by scope",enabled:!0,example:`const configs = await coreSDK.initConfigs({ version: '1.0.0', scopes: ['gameplay', 'ui'] });

configs.getAll();
// { gameplay: { maxLives: 3, ... }, ui: { theme: 'dark', ... } }`},{name:"configResult.getMeta",description:"Get segment and A/B test metadata",enabled:!0,example:`const configs = await coreSDK.initConfigs({ version: '1.0.0', scopes: ['gameplay'] });

configs.getMeta();
// { segment: 'premium', ab: 'test_a', abG: 'control', abExp: 1234567890 }`},{name:"configResult.raw",description:"Get raw ConfigResponse from server",enabled:!0,example:`const configs = await coreSDK.initConfigs({ version: '1.0.0', scopes: ['gameplay'] });

configs.raw();
// Original ConfigResponse: { segment, ab, abG, abExp, configs: {...} }`}]},{name:"profile",description:"User profile methods",methods:[{name:"profile.getProfile",description:"Get full user profile",enabled:!0,example:`const profile = await coreSDK.profile.getProfile();
// { id, version, base: { name, avatar }, scopes: { game: {...} } }`},{name:"profile.updateProfile",description:"Update profile (partial merge)",enabled:!0,example:`await coreSDK.profile.updateProfile({
  base: { name: "NewName" },
  scopes: { game: { level: 10 } }
});`},{name:"profile.getProfileField",description:"Get field value by dot-notation path",enabled:!0,example:'const level = await coreSDK.profile.getProfileField("scopes.game.level");'},{name:"profile.setProfileField",description:"Set field value by dot-notation path",enabled:!0,example:'await coreSDK.profile.setProfileField("scopes.game.coins", 1000);'},{name:"profile.mergeProfileScope",description:"Merge data into specific scope",enabled:!0,example:'await coreSDK.profile.mergeProfileScope("game", { xp: 500, level: 10 });'},{name:"profile.invalidate",description:"Invalidate profile cache for specific player",enabled:!0,example:'coreSDK.profile.invalidate("player-id");'},{name:"profile.invalidateAll",description:"Invalidate all profile cache",enabled:!0,example:"coreSDK.profile.invalidateAll();"},{name:"profile.resetMyProfileId",description:"Reset current player profile ID (for logout)",enabled:!0,example:"coreSDK.profile.resetMyProfileId();"}]},{name:"kv",description:"Key-Value storage for player data",methods:[{name:"kv.get",description:"Get value by key",enabled:!0,example:'const { value } = await coreSDK.playerKv.get("settings");'},{name:"kv.set",description:"Set value by key",enabled:!0,example:'await coreSDK.playerKv.set("settings", JSON.stringify({ theme: "dark" }));'},{name:"kv.delete",description:"Delete value by key",enabled:!0,example:'await coreSDK.playerKv.delete("settings");'},{name:"kv.exists",description:"Check if key exists",enabled:!0,example:'const { exists } = await coreSDK.playerKv.exists("settings");'},{name:"kv.getMany",description:"Get multiple values by keys",enabled:!0,example:'const values = await coreSDK.playerKv.getMany(["key1", "key2"]);'},{name:"kv.list",description:"List all keys",enabled:!0,example:"const { keys } = await coreSDK.playerKv.list();"},{name:"kv.setMany",description:"Set multiple key-value pairs",enabled:!0,example:`await coreSDK.playerKv.setMany([
  { key: "settings", value: JSON.stringify({ theme: "dark" }) },
  { key: "progress", value: JSON.stringify({ level: 5 }) }
]);`},{name:"kv.deleteMany",description:"Delete multiple keys",enabled:!0,example:'await coreSDK.playerKv.deleteMany(["key1", "key2", "key3"]);'}]},{name:"health",description:"Health check API",methods:[{name:"health.check",description:"Quick health check",enabled:!0,example:`const health = await coreSDK.health.check();
// { status: "ok", timestamp: 1234567890 }`},{name:"health.version",description:"Get service version",enabled:!0,example:"const { version, name } = await coreSDK.health.version();"},{name:"health.getVersion",description:"Get service version (alias)",enabled:!0,example:"const version = await coreSDK.health.getVersion();"},{name:"health.detailed",description:"Get detailed health check with dependencies",enabled:!0,example:`const detailed = await coreSDK.health.detailed();
// { status: "ok", database: "ok", redis: "ok", ... }`}]},{name:"gamestate",description:"Game state persistence",methods:[{name:"gamestate.get",description:"Load current game state",enabled:!0,example:`const { meta } = await coreSDK.gamestate.get();
// meta contains saved game progress`},{name:"gamestate.update",description:"Update game state (deep merge on backend)",enabled:!0,example:`await coreSDK.gamestate.update({
  level: 5,
  coins: 120,
  settings: { sound: false }
});`}]},{name:"abTests",description:"A/B Tests Admin API (disabled)",methods:[{name:"abTests.getAll",description:"Get all A/B tests",enabled:!1,example:"const tests = await coreSDK.abTests.getAll();"},{name:"abTests.getActive",description:"Get all active A/B tests",enabled:!1,example:"const activeTests = await coreSDK.abTests.getActive();"},{name:"abTests.getById",description:"Get A/B test by ID",enabled:!1,example:'const test = await coreSDK.abTests.getById("test-id");'},{name:"abTests.getVariant",description:"Get A/B test variant for current user",enabled:!1,example:'const variant = await coreSDK.abTests.getVariant("test-key");'},{name:"abTests.create",description:"Create A/B test",enabled:!1,example:'await coreSDK.abTests.create({ key: "test", name: "Test", groups: [...] });'},{name:"abTests.update",description:"Update A/B test (full replace)",enabled:!1,example:'await coreSDK.abTests.update("test-id", { name: "Updated Test", ... });'},{name:"abTests.patch",description:"Partially update A/B test",enabled:!1,example:'await coreSDK.abTests.patch("test-id", { name: "New Name" });'},{name:"abTests.delete",description:"Delete A/B test",enabled:!1,example:'await coreSDK.abTests.delete("test-id");'}]},{name:"remoteConfigs",description:"Remote Configs Admin API (disabled)",methods:[{name:"remoteConfigs.getAll",description:"Get all remote configs",enabled:!1,example:"const configs = await coreSDK.remoteConfigs.getAll();"},{name:"remoteConfigs.getById",description:"Get remote config by ID",enabled:!1,example:'const config = await coreSDK.remoteConfigs.getById("config-id");'},{name:"remoteConfigs.create",description:"Create remote config",enabled:!1,example:'await coreSDK.remoteConfigs.create({ key: "ui", scope: "ui", data: {...} });'},{name:"remoteConfigs.update",description:"Update remote config",enabled:!1,example:'await coreSDK.remoteConfigs.update("config-id", { data: {...} });'},{name:"remoteConfigs.delete",description:"Delete remote config",enabled:!1,example:'await coreSDK.remoteConfigs.delete("config-id");'},{name:"remoteConfigs.refresh",description:"Refresh remote configs cache",enabled:!1,example:"await coreSDK.remoteConfigs.refresh();"}]},{name:"segments",description:"Segments Admin API (disabled)",methods:[{name:"segments.getAll",description:"Get all segments",enabled:!1,example:"const segments = await coreSDK.segments.getAll();"},{name:"segments.getById",description:"Get segment by ID",enabled:!1,example:'const segment = await coreSDK.segments.getById("segment-id");'},{name:"segments.getUserSegments",description:"Get segments for current user",enabled:!1,example:"const userSegments = await coreSDK.segments.getUserSegments();"},{name:"segments.create",description:"Create segment",enabled:!1,example:'await coreSDK.segments.create({ key: "vip", name: "VIP", filters: {...} });'},{name:"segments.update",description:"Update segment",enabled:!1,example:'await coreSDK.segments.update("segment-id", { name: "Premium VIP" });'},{name:"segments.delete",description:"Delete segment",enabled:!1,example:'await coreSDK.segments.delete("segment-id");'}]},{name:"users",description:"Users Admin API (disabled)",methods:[{name:"users.getAll",description:"Get all users",enabled:!1,example:"const users = await coreSDK.users.getAll();"},{name:"users.getById",description:"Get user by ID",enabled:!1,example:'const user = await coreSDK.users.getById("user-id");'},{name:"users.search",description:"Search users by query",enabled:!1,example:'const results = await coreSDK.users.search({ email: "user@example.com" });'},{name:"users.create",description:"Create user",enabled:!1,example:'await coreSDK.users.create({ email: "user@example.com", name: "User" });'},{name:"users.update",description:"Update user",enabled:!1,example:'await coreSDK.users.update("user-id", { name: "New Name" });'},{name:"users.delete",description:"Delete user",enabled:!1,example:'await coreSDK.users.delete("user-id");'}]},{name:"eventsApi",description:"Events Analytics API (disabled)",methods:[{name:"events.getAll",description:"Get all events",enabled:!1,example:"const events = await coreSDK.events.getAll();"},{name:"events.send",description:"Send analytics event",enabled:!1,example:'await coreSDK.events.send({ name: "level_complete", data: { level: 5 } });'}]},{name:"ad",description:"Ad methods",methods:[{name:"showAd",description:"Show ad for a placement",enabled:!0},{name:"initAds",description:"Initialize ads subsystem",enabled:!0},{name:"__setConfigForTests",description:"[DEV] Inject config directly into SDK",enabled:!0},{name:"__setAdsMediatorForTests",description:"[DEV] Inject ad mediator implementation",enabled:!0}]}];function yt(n){for(const e of A)for(const t of e.methods)if(t.name===n)return t.enabled;return!1}function St(n){return!!A.find(t=>t.name===n)}function wt(){const n=[];for(const e of A)if(e)for(const t of e.methods)t.enabled&&n.push(t.name);return n}function bt(n){return A.find(t=>t.name===n)?.methods??[]}function vt(n,e){for(const t of A)for(const s of t.methods)if(s.name===n){s.enabled=e;return}}typeof window<"u"&&(window.coreSDK=ke),u.AbTestsApiClient=ge,u.ApiClient=Q,u.AuthApiClient=Se,u.AuthModal=ee,u.ConfigResult=J,u.ConfigsApiClient=he,u.CoreSDK=S,u.EventBus=X,u.GoogleAuthHelper=_,u.HealthApiClient=ye,u.PlayerKVApiClient=we,u.RemoteConfigsApiClient=fe,u.SDK_EVENTS=y,u.SDK_METHODS=A,u.SDK_VERSION=K,u.SUPPORTED_VERSIONS=x,u.SegmentsApiClient=pe,u.UsersApiClient=me,u.coreSDK=ke,u.getEnabledMethods=wt,u.getMethodsByCategory=bt,u.isCategoryEnabled=St,u.isMethodEnabled=yt,u.isVersionSupported=be,u.sdkConfig=f,u.setAuthUrl=G,u.setBaseUrl=O,u.setMethodEnabled=vt,u.validateVersion=ve,Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})}));
</script>
<!-- App entry -->
<script src="js/index.js"></script>

</body>
</html>
